<% content_for :title, "CMS Dashboard" %>

<div class="space-y-6">
  <!-- Header -->
  <div class="md:flex md:items-center md:justify-between">
    <div class="min-w-0 flex-1">
      <h1 class="text-2xl font-bold leading-7 text-gray-900 sm:truncate sm:text-3xl sm:tracking-tight">
        CMS Dashboard
      </h1>
      <p class="mt-1 text-sm text-gray-500">
        Manage your blog posts, pages, and content
      </p>
    </div>
    <div class="mt-4 flex md:ml-4 md:mt-0">
      <%= link_to "New Post", new_admin_cms_post_path,
          class: "inline-flex items-center rounded-md bg-blue-600 px-3 py-2 text-sm font-semibold text-white shadow-sm hover:bg-blue-500 focus-visible:outline focus-visible:outline-2 focus-visible:outline-offset-2 focus-visible:outline-blue-600" %>
    </div>
  </div>

  <!-- Stats Grid -->
  <div class="grid grid-cols-1 gap-5 sm:grid-cols-2 lg:grid-cols-4">
    <!-- Total Posts -->
    <div class="relative overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:px-6 sm:py-6">
      <dt>
        <div class="absolute rounded-md bg-blue-500 p-3">
          <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M12 7.5h1.5m-1.5 3h1.5m-7.5 3h7.5m-7.5 3h7.5m2.25-13.5L21 21l-5.25-5.25a1.125 1.125 0 01-.504-.864l-.25-4.5M16.5 7.5L15 6l-1.5 1.5M21 21l-2.8-2.8" />
          </svg>
        </div>
        <p class="ml-16 truncate text-sm font-medium text-gray-500">Total Posts</p>
      </dt>
      <dd class="ml-16 flex items-baseline">
        <p class="text-2xl font-semibold text-gray-900"><%= @stats[:total_posts] %></p>
      </dd>
    </div>

    <!-- Published Posts -->
    <div class="relative overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:px-6 sm:py-6">
      <dt>
        <div class="absolute rounded-md bg-green-500 p-3">
          <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9 12.75L11.25 15 15 9.75M21 12a9 9 0 11-18 0 9 9 0 0118 0z" />
          </svg>
        </div>
        <p class="ml-16 truncate text-sm font-medium text-gray-500">Published Posts</p>
      </dt>
      <dd class="ml-16 flex items-baseline">
        <p class="text-2xl font-semibold text-gray-900"><%= @stats[:published_posts] %></p>
      </dd>
    </div>

    <!-- Total Pages -->
    <div class="relative overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:px-6 sm:py-6">
      <dt>
        <div class="absolute rounded-md bg-purple-500 p-3">
          <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
          </svg>
        </div>
        <p class="ml-16 truncate text-sm font-medium text-gray-500">Total Pages</p>
      </dt>
      <dd class="ml-16 flex items-baseline">
        <p class="text-2xl font-semibold text-gray-900"><%= @stats[:total_pages] %></p>
      </dd>
    </div>

    <!-- Categories -->
    <div class="relative overflow-hidden rounded-lg bg-white px-4 py-5 shadow sm:px-6 sm:py-6">
      <dt>
        <div class="absolute rounded-md bg-orange-500 p-3">
          <svg class="h-6 w-6 text-white" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" />
          </svg>
        </div>
        <p class="ml-16 truncate text-sm font-medium text-gray-500">Categories</p>
      </dt>
      <dd class="ml-16 flex items-baseline">
        <p class="text-2xl font-semibold text-gray-900"><%= @stats[:categories] %></p>
      </dd>
    </div>
  </div>

  <!-- Quick Actions -->
  <div class="rounded-lg bg-white shadow">
    <div class="px-4 py-5 sm:p-6">
      <h3 class="text-base font-semibold leading-6 text-gray-900">Quick Actions</h3>
      <div class="mt-5">
        <div class="grid grid-cols-1 gap-4 sm:grid-cols-2 lg:grid-cols-4">
          <%= link_to new_admin_cms_post_path,
              class: "relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" do %>
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-blue-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
            </div>
            <div class="flex-1 min-w-0">
              <span class="absolute inset-0" aria-hidden="true"></span>
              <p class="text-sm font-medium text-gray-900">New Post</p>
              <p class="text-sm text-gray-500">Create a new blog post</p>
            </div>
          <% end %>

          <%= link_to new_admin_cms_page_path,
              class: "relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" do %>
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-purple-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M12 4.5v15m7.5-7.5h-15" />
              </svg>
            </div>
            <div class="flex-1 min-w-0">
              <span class="absolute inset-0" aria-hidden="true"></span>
              <p class="text-sm font-medium text-gray-900">New Page</p>
              <p class="text-sm text-gray-500">Create a new static page</p>
            </div>
          <% end %>

          <%= link_to admin_cms_categories_path,
              class: "relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" do %>
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-orange-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M9.568 3H5.25A2.25 2.25 0 003 5.25v4.318c0 .597.237 1.17.659 1.591l9.581 9.581c.699.699 1.78.872 2.607.33a18.095 18.095 0 005.223-5.223c.542-.827.369-1.908-.33-2.607L11.16 3.66A2.25 2.25 0 009.568 3z" />
              </svg>
            </div>
            <div class="flex-1 min-w-0">
              <span class="absolute inset-0" aria-hidden="true"></span>
              <p class="text-sm font-medium text-gray-900">Categories</p>
              <p class="text-sm text-gray-500">Manage post categories</p>
            </div>
          <% end %>

          <%= link_to "/sitemap.xml", target: "_blank",
              class: "relative rounded-lg border border-gray-300 bg-white px-6 py-5 shadow-sm flex items-center space-x-3 hover:border-gray-400 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500" do %>
            <div class="flex-shrink-0">
              <svg class="h-6 w-6 text-green-600" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                <path stroke-linecap="round" stroke-linejoin="round" d="M21 21l-5.197-5.197m0 0A7.5 7.5 0 105.196 5.196a7.5 7.5 0 0010.607 10.607z" />
              </svg>
            </div>
            <div class="flex-1 min-w-0">
              <span class="absolute inset-0" aria-hidden="true"></span>
              <p class="text-sm font-medium text-gray-900">View Sitemap</p>
              <p class="text-sm text-gray-500">Check SEO sitemap</p>
            </div>
          <% end %>
        </div>
      </div>
    </div>
  </div>

  <!-- Content Tables -->
  <div class="grid grid-cols-1 gap-6 lg:grid-cols-2">
    <!-- Recent Posts -->
    <div class="bg-white shadow rounded-lg">
      <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-lg leading-6 font-medium text-gray-900">Recent Posts</h3>
          <%= link_to "View all", admin_cms_posts_path, class: "text-sm text-blue-600 hover:text-blue-500" %>
        </div>
      </div>
      <div class="px-4 py-5 sm:p-6">
        <% if @recent_posts.any? %>
          <div class="space-y-4">
            <% @recent_posts.each do |post| %>
              <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 truncate">
                    <%= link_to post.title, admin_cms_post_path(post), class: "hover:text-blue-600" %>
                  </p>
                  <p class="text-sm text-gray-500">
                    <%= post.category&.name || "Uncategorized" %> • 
                    <%= time_ago_in_words(post.created_at) %> ago
                  </p>
                </div>
                <div class="flex-shrink-0">
                  <%= post_status_badge(post) %>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <p class="text-sm text-gray-500">No posts yet</p>
        <% end %>
      </div>
    </div>

    <!-- Recent Pages -->
    <div class="bg-white shadow rounded-lg">
      <div class="px-4 py-5 sm:px-6 border-b border-gray-200">
        <div class="flex items-center justify-between">
          <h3 class="text-lg leading-6 font-medium text-gray-900">Recent Pages</h3>
          <%= link_to "View all", admin_cms_pages_path, class: "text-sm text-blue-600 hover:text-blue-500" %>
        </div>
      </div>
      <div class="px-4 py-5 sm:p-6">
        <% if @recent_pages.any? %>
          <div class="space-y-4">
            <% @recent_pages.each do |page| %>
              <div class="flex items-center justify-between">
                <div class="flex-1 min-w-0">
                  <p class="text-sm font-medium text-gray-900 truncate">
                    <%= link_to page.title, admin_cms_page_path(page), class: "hover:text-blue-600" %>
                  </p>
                  <p class="text-sm text-gray-500">
                    <%= page.template_name.humanize %> • 
                    <%= time_ago_in_words(page.created_at) %> ago
                  </p>
                </div>
                <div class="flex-shrink-0">
                  <%= post_status_badge(page) %>
                </div>
              </div>
            <% end %>
          </div>
        <% else %>
          <p class="text-sm text-gray-500">No pages yet</p>
        <% end %>
      </div>
    </div>
  </div>
</div>