<%= render Railsplan::UI::DocsLayoutComponent.new(
  title: @doc_content ? @doc_content[:title] : "Documentation",
  description: "A fully-featured template for building AI-native SaaS applications on top of Rails Edge",
  navigation_items: docs_navigation_items,
  table_of_contents: docs_table_of_contents
) do %>

  <% if @doc_content %>
    <%= simple_format(markdown_to_html(@doc_content[:raw_content])) %>
  <% else %>
    <!-- Default documentation index -->
    <header class="not-prose mb-9 space-y-1">
      <p class="font-medium text-primary-600 dark:text-primary-400">Documentation</p>
      <h1 class="text-3xl font-bold tracking-tight text-gray-900 dark:text-gray-100">
        Rails SaaS Starter Template
      </h1>
      <p class="text-lg text-gray-700 dark:text-gray-300">
        A fully-featured template for building AI-native SaaS applications on top of Rails Edge. 
        This documentation covers all the modules and features available.
      </p>
    </header>

    <div class="not-prose mb-16 mt-12 grid grid-cols-1 gap-6 sm:grid-cols-2">
      <% @doc_sections.each do |section| %>
        <%= render Railsplan::UI::CardComponent.new(padding: :default) do %>
          <div class="group relative">
            <div class="flex items-center space-x-3">
              <div class="flex-shrink-0">
                <div class="flex h-10 w-10 items-center justify-center rounded-lg bg-primary-100 dark:bg-primary-900/50">
                  <svg class="h-6 w-6 text-primary-600 dark:text-primary-400" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                    <% case section[:title] %>
                    <% when 'Getting Started' %>
                      <path stroke-linecap="round" stroke-linejoin="round" d="M5.25 5.653c0-.856.917-1.398 1.667-.986l11.54 6.348a1.125 1.125 0 010 1.971l-11.54 6.347a1.125 1.125 0 01-1.667-.985V5.653z" />
                    <% when 'Architecture' %>
                      <path stroke-linecap="round" stroke-linejoin="round" d="M8.25 21v-4.875c0-.621.504-1.125 1.125-1.125h2.25c.621 0 1.125.504 1.125 1.125V21m0 0h4.5V3.545M12.75 21h7.5V10.75M2.25 21h1.5m18 0h-18M2.25 9l4.5-1.636M18.75 3l-1.5.545m0 6.205l3 1m1.5.5l-1.5-.5M6.75 7.364V3h-3v18m3-13.636l10.5-3.819" />
                    <% when 'Modules' %>
                      <path stroke-linecap="round" stroke-linejoin="round" d="M2.25 7.125C2.25 6.504 2.754 6 3.375 6h6c.621 0 1.125.504 1.125 1.125v3.75c0 .621-.504 1.125-1.125 1.125h-6A1.125 1.125 0 012.25 10.875v-3.75zM14.25 8.625c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v8.25c0 .621-.504 1.125-1.125 1.125h-5.25a1.125 1.125 0 01-1.125-1.125v-8.25zM3.75 16.125c0-.621.504-1.125 1.125-1.125h5.25c.621 0 1.125.504 1.125 1.125v2.25c0 .621-.504 1.125-1.125 1.125h-5.25A1.125 1.125 0 013.75 18.375v-2.25z" />
                    <% else %>
                      <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 14.25v-2.625a3.375 3.375 0 00-3.375-3.375h-1.5A1.125 1.125 0 0113.5 7.125v-1.5a3.375 3.375 0 00-3.375-3.375H8.25m0 12.75h7.5m-7.5 3H12M10.5 2.25H5.625c-.621 0-1.125.504-1.125 1.125v17.25c0 .621.504 1.125 1.125 1.125h12.75c.621 0 1.125-.504 1.125-1.125V11.25a9 9 0 00-9-9z" />
                    <% end %>
                  </svg>
                </div>
              </div>
              <div class="flex-1 min-w-0">
                <h2 class="text-lg font-semibold text-gray-900 dark:text-gray-100">
                  <a href="/docs/<%= section[:items].first[:path] if section[:items].any? %>" class="group-hover:text-primary-600 dark:group-hover:text-primary-400">
                    <%= section[:title] %>
                  </a>
                </h2>
                <p class="text-sm text-gray-600 dark:text-gray-400">
                  <%= case section[:title]
                      when 'Getting Started'
                        'Setup, configuration, and basic usage guides'
                      when 'Architecture' 
                        'Technical documentation and system design'
                      when 'Modules'
                        'Feature modules and their capabilities'
                      when 'Implementation Guides'
                        'Detailed implementation documentation'
                      else
                        'Documentation and guides'
                      end %>
                </p>
              </div>
              <div class="flex-shrink-0">
                <svg class="h-5 w-5 text-gray-400 group-hover:text-primary-500" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5L21 12m0 0l-7.5 7.5M21 12H3" />
                </svg>
              </div>
            </div>
          </div>
        <% end %>
      <% end %>
    </div>
  <% end %>

<% end %>

<% content_for :head do %>
  <script>
    // Simple markdown to HTML converter for client-side rendering
    function markdownToHtml(markdown) {
      return markdown
        .replace(/^### (.*$)/gim, '<h3>$1</h3>')
        .replace(/^## (.*$)/gim, '<h2>$1</h2>')
        .replace(/^# (.*$)/gim, '<h1>$1</h1>')
        .replace(/\*\*(.*)\*\*/gim, '<strong>$1</strong>')
        .replace(/\*(.*)\*/gim, '<em>$1</em>')
        .replace(/\`(.*)\`/gim, '<code>$1</code>')
        .replace(/\n/gim, '<br>');
    }
  </script>
<% end %>